---
date: 2022-3-13
title: MySQL知识点
tags: MySQL
categories: Java学习
cover: /img/cover/mysql_1.png

---

# MySQL知识点

#### 何为事务？

事务是逻辑上的一组操作，要么都执行，要么都不执行。

#### 事务的ACID特性

- 原子性`Atomicity`：事务是最下的执行单位，不允许分割。事务的原子性确保动作要么全部成功，要么全部失败。
- 一致性`Consistency`：执行事务前后，数据保持一致，例如转账业务中，无论事务是否成功，转账者和收款人的总额应该是不变的。
- 隔离性`Isolation`：并发访问数据库时，一个用户的事务不被其他事务所干扰，各并发事务之间数据库是独立的。
- 持久性`Durability`：一个事务被提交后，它对数据库中数据的改变是持久的，即使数据库发生故障也不应该对其有任何影响。

#### 并发事务的问题

- 脏读`Dirty read`：当一个事务正在访问数据并对数据进行了修改，而这种修改还没有提交到数据库中，这时另外一个事务也访问了这个数据，然后使用了这个数据，因为这个数据是还没有提交的数据，那么另外一个事务读到的这个数据是一个“脏数据”，根据“脏数据”所做的操作可能是不正确的。
- 丢失修改`Lost to Modify`：指在一个事务读取一个数据时，另外一个事务也访问了该数据，那么在第一个事务中修改了这个数据后，第二个数据也修改了这个数据。这样第一个事务内修改结果就被丢失，因此称为丢失修改。例如：事务1读取某表中的数据A=20，事务2也读取A=20，事务1修改A=A-1，事务2也修改A=A-1，最终结果A=19，事务1的修改被丢失。
- 不可重复读`Unrepeatable read`：指在一个事务内多次读同一个数据。在这个事务还没有结束时，另一个事务也访问该数据。那么在第一个事务中的两次读数据之间，由于第二个事务的修改导致第一个事务两次读到的数据可能会不一致。称为不可重复读。
- 幻读`Phantom read`：幻读与不可重复读类似。它发生在一个事务读了几行数据，接着另一个并发事务插入了一些数据。在随后的查询中，第一个事务就会发现多了一些原本不存在的数据，称为幻读。

> #### 不可重复读和幻读的区别：
>
> 不可重复读的重点是修改，如多次读取一条数据发现其中某些列的值被修改；幻读的重点在于新增或者删除，如多次查询同一条数据，发现记录增多或者减少。

#### 事务隔离级别有哪些？

SQL标准定义了四个隔离级别：

- READ-UNCOMMITTED（读取未提交）：最低的隔离级别，允许读取尚未提交的数据变更，可能会导致脏读、幻读或者不可重复读。
- READ-COMMITTED（读取已提交)：允许读取并发事务已经提交的数据，可以阻止脏读，但是幻读或者不可重复读仍有可能发生。
- REPEATABLE-READ（可重复读）：对同一字段的多次读取结果都一致的，除非数据是被本身事务自己所修改的。可以阻止脏读和不可重复读，但幻读仍有可能发生。
- SERIALIZABLE(可串行化)：最高的隔离级别，完成服从ACID的隔离级别。所有的事务依次逐个执行，这个事务之间就完全不可能产生干扰，也就是该级别可以防止脏读、不可重复读以及幻读。

| 隔离级别         | 脏读 | 不可重复读 | 幻读 |
| ---------------- | :--: | :--------: | :--: |
| READ-UNCOMMITTED |  √   |     √      |  √   |
| READ-COMMITTED   |  x   |     √      |  √   |
| REPEATABLE-READ  |  x   |     x      |  √   |
| SERIALIZABLE     |  x   |     x      |  x   |



